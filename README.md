# 缭乱 (LiaoLuan) — 新野兽派极简效率工具

> **「拒绝精致的伪装，直面生活的粗粝。」**

**缭乱 (LiaoLuan)** 是一款采用 **Neo-Brutalism (新野兽派)** 设计风格的 Android 个人效率应用。它摒弃了传统 Material Design 的圆润与柔和，用大胆的黑白高对比度、粗犷的边框和非传统的布局，为你提供一个最纯粹的任务、习惯与灵感管理平台。

---

## ✨ 核心功能

### 📋 任务清单 (Tasks)
- **快速创建与编辑** — 极速录入任务名称与详细描述
- **三级优先级视觉系统** — 低 / 中 / 高优先级，高饱和度色彩冲击
- **场景化标签** — 工作、生活、紧急、学习四大核心场景标签筛选
- **精确截止时间 + 动态倒计时** — 实时显示剩余时间，营造紧迫感
- **自定义提醒语** — 在通知栏用个性化文字鞭策自己
- **智能归档** — 左滑完成，自动归档保持列表清爽

### 🔥 习惯养成 (Habits)
- **灵活排程** — 自定义执行频率（周一/三/五等）和时间窗口
- **量化目标** — 设定每日目标值、单位和单次步进值
- **双模式支持** — 普通打卡模式 & 时长专注模式（含前台计时服务）
- **间隔循环提醒** — 在时间窗口内每隔 N 分钟循环提醒
- **连胜 (Streak) 统计** — 连续坚持天数实时展示
- **习惯日历 + 历史回溯** — 周视图日历，支持查看任意日期的完成情况
- **热力图统计** — 月度习惯完成数据可视化

### 📝 灵感笔记 (Notes)
- **极简编辑器** — 无干扰纯文本编辑
- **图文混排** — 支持插入图片，自动压缩
- **情绪标记** — 每条笔记可标记当时心境
- **置顶与折叠** — 重要笔记置顶，列表智能预览

### 💾 数据安全
- **全量 JSON 备份与恢复** — 支持任务、习惯、习惯历史、笔记的完整导入导出
- **事务保护** — 数据导入采用 `@Transaction` 原子操作，杜绝中途崩溃导致数据丢失
- **崩溃日志持久化** — 本地保存最近 5 次崩溃栈，便于问题排查

---

## 🎨 设计哲学：Neo-Brutalism

| 原则 | 实现 |
|------|------|
| **高对比度** | 纯黑 `#000000` + 纯白 `#FFFFFF` 为主基调，辅以高饱和度的蓝/黄/红 |
| **粗轮廓** | 所有 UI 元素带有 2dp-4dp 纯黑边框，拒绝模糊阴影 |
| **人文字体** | 集成瘦身版 **LXGW WenKai (霞鹜文楷)**，粗犷中注入人文气息 |
| **直角硬阴影** | 黑色实体色块作为阴影，立体剪纸感 |

---

## 🛠️ 技术架构

本项目采用 **100% Kotlin** 编写，遵循现代 Android 工程最高标准。

| 层级 | 技术选型 |
|------|----------|
| **UI 框架** | Jetpack Compose (Material3) |
| **架构模式** | 单 Activity + MVI (Model-View-Intent) |
| **依赖注入** | Dagger Hilt |
| **本地存储** | Room Database (SQLite) — 含复合索引优化 |
| **后台任务** | WorkManager + AlarmManager (精确闹钟) |
| **异步编程** | Kotlin Coroutines & StateFlow |
| **图片加载** | Coil |
| **序列化** | Kotlinx Serialization |

### 项目模块结构

```
liaoluan/
├── app/                    # 主模块 — Activity, ViewModel, Service, Receiver, Worker
├── core/
│   ├── database/           # Room 数据库 — Entity, DAO, Repository
│   └── designsystem/       # 共享 UI — Theme, Colors, Typography, DateHandle
└── feature/
    ├── habits/             # 习惯管理界面
    ├── notes/              # 笔记管理界面
    ├── stats/              # 统计热力图界面
    └── tasks/              # 任务管理界面
```

---

## 🏗️ 构建指南

1. 确保安装 **Android Studio Ladybug** 或更高版本
2. 克隆本项目：
   ```bash
   git clone https://github.com/luzzr-123/liaoluan.git
   ```
3. 等待 Gradle Sync 完成
4. 连接 Android 调试设备或启动模拟器 (minSdk 26 / Android 8.0+)
5. 点击 **Run 'app'**

---

## 📋 更新日志

### v1.1 — 深度优化与 Feature 补齐 (2026-03-01)

**🔴 致命级修复 (P0)**
- **数据一致性护航**：全量 JSON 备份与恢复接入 Room 原生 `@Transaction` 事务原子保护，彻底杜绝异常中断导致的数据清零。
- **专注计时校准**：移除系统时间依赖，前后台服务均改用 `SystemClock.elapsedRealtime()` 单调时钟，抵御本地任意修改与系统跳变。
- **容灾熔断**：重构并解耦无效时间逻辑，修复了无截止任务导致的非法数据解析黑屏。

**🟠 高危级修复 (P1)**
- **连击系统重构**：加入 `isStreakBroken` 日期追溯引擎，精准修复跨天重置、非每日目标时 `streakDays` 被错误打断的严重统计 Bug。
- **通知渠道聚合**：统一前台计时服务和普通通知的 Notification Channel，解决双重创建导致的频道冲突与异常发版机制。
- **IO 互斥锁**：修正 `MainScreen` 调用导出选择器时因未解绑 Modal 导致的生命周期竞态崩溃。

**🟡 中等级修复与特性补完 (P2)**
- **标签快捷筛选**：真正实现了任务“工作/生活/紧急/学习”高低优多维过滤。
- **历史归档查询**：补齐底栏切换，支持完整的回溯已完成 (已挂起) 任务。
- **实时倒计时**：补全未完成任务到期限制的动态倒计时面板 (天/时/分)。
- **沉浸式后退**：修复 `StatsScreen` 与 `SettingsModal` 因缺少 Compose `BackHandler` 拦截而引发的原生返回穿透问题。
- **无缝恢复**：全流量数据恢复阶段自动激活并重建底层闹钟集群管理。
- **触控去抖与分离**：消灭 `NoteScreen` UI 多层 `clickable` 嵌套带来的点击误触发与长按无效化 Bug。

**🟢 架构低危治理 (P3)**
- **重组优化**：分离业务稳态，为主体意图数据 `ToastData` 新增 `@Immutable` 注解。
- **解耦操作**：切断强硬编码的默认时间轴及页面越权跨层调用的脏代码。

### v1.0 — 初始发布
- 任务管理、习惯追踪、灵感笔记三大核心模块
- 习惯日历与历史回溯
- 全量 JSON 备份与恢复
- Neo-Brutalism 设计系统

---

## 📄 许可证

本项目为个人项目。

---

*Created with ❤️ & Brutality by Luuzr*
